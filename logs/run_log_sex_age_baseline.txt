所有输出将被记录到文件: run_log_sex_age_baseline.txt
============================================================
已将所有列名转换为字符串类型。
已将 'Sex' 列的 'M'/'F' 转换为 1/0。

在数据中找到的方法: ['combat_loess' 'harmony_loess' 'loess' 'log' 'median_loess' 'ratio_loess'
 'ruv_loess']
--------------------------------------------------

========================= 开始处理方法: combat_loess =========================
方法 'combat_loess' 的完整训练集大小: 392
方法 'combat_loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.3302, 标准差 = 0.0621
性别预测模型已保存至: model_sex_combat_loess.joblib
测试集评估 (MCC): 0.3061
测试集分类报告:
               precision    recall  f1-score   support

           F     0.7949    0.2348    0.3626       132
           M     0.6773    0.9636    0.7955       220

    accuracy                         0.6903       352
   macro avg     0.7361    0.5992    0.5790       352
weighted avg     0.7214    0.6903    0.6332       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1593, 标准差 = 0.0265
年龄预测模型已保存至: model_age_combat_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4473, P-value = 0.0000

========================= 开始处理方法: harmony_loess =========================
方法 'harmony_loess' 的完整训练集大小: 392
方法 'harmony_loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2793, 标准差 = 0.0665
性别预测模型已保存至: model_sex_harmony_loess.joblib
测试集评估 (MCC): 0.2036
测试集分类报告:
               precision    recall  f1-score   support

           F     0.6765    0.1742    0.2771       132
           M     0.6572    0.9500    0.7770       220

    accuracy                         0.6591       352
   macro avg     0.6669    0.5621    0.5270       352
weighted avg     0.6644    0.6591    0.5895       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1497, 标准差 = 0.0281
年龄预测模型已保存至: model_age_harmony_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4317, P-value = 0.0000

========================= 开始处理方法: loess =========================
方法 'loess' 的完整训练集大小: 392
方法 'loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.1873, 标准差 = 0.1246
性别预测模型已保存至: model_sex_loess.joblib
测试集评估 (MCC): 0.1368
测试集分类报告:
               precision    recall  f1-score   support

           F     0.5417    0.1970    0.2889       132
           M     0.6513    0.9000    0.7557       220

    accuracy                         0.6364       352
   macro avg     0.5965    0.5485    0.5223       352
weighted avg     0.6102    0.6364    0.5807       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.0813, 标准差 = 0.0224
年龄预测模型已保存至: model_age_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.3551, P-value = 0.0000

========================= 开始处理方法: log =========================
方法 'log' 的完整训练集大小: 392
方法 'log' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.1862, 标准差 = 0.0783
性别预测模型已保存至: model_sex_log.joblib
测试集评估 (MCC): 0.1844
测试集分类报告:
               precision    recall  f1-score   support

           F     0.6316    0.1818    0.2824       132
           M     0.6561    0.9364    0.7715       220

    accuracy                         0.6534       352
   macro avg     0.6438    0.5591    0.5269       352
weighted avg     0.6469    0.6534    0.5881       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.0590, 标准差 = 0.0173
年龄预测模型已保存至: model_age_log.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.3334, P-value = 0.0000

========================= 开始处理方法: median_loess =========================
方法 'median_loess' 的完整训练集大小: 392
方法 'median_loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2069, 标准差 = 0.0737
性别预测模型已保存至: model_sex_median_loess.joblib
测试集评估 (MCC): 0.3100
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8667    0.1970    0.3210       132
           M     0.6708    0.9818    0.7970       220

    accuracy                         0.6875       352
   macro avg     0.7687    0.5894    0.5590       352
weighted avg     0.7443    0.6875    0.6185       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1358, 标准差 = 0.0153
年龄预测模型已保存至: model_age_median_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4286, P-value = 0.0000

========================= 开始处理方法: ratio_loess =========================
方法 'ratio_loess' 的完整训练集大小: 392
方法 'ratio_loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2852, 标准差 = 0.1349
性别预测模型已保存至: model_sex_ratio_loess.joblib
测试集评估 (MCC): 0.3666
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8571    0.2727    0.4138       132
           M     0.6903    0.9727    0.8075       220

    accuracy                         0.7102       352
   macro avg     0.7737    0.6227    0.6107       352
weighted avg     0.7529    0.7102    0.6599       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1429, 标准差 = 0.0537
年龄预测模型已保存至: model_age_ratio_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4089, P-value = 0.0000

========================= 开始处理方法: ruv_loess =========================
方法 'ruv_loess' 的完整训练集大小: 392
方法 'ruv_loess' 的测试集大小: 352

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2236, 标准差 = 0.1267
性别预测模型已保存至: model_sex_ruv_loess.joblib
测试集评估 (MCC): 0.2588
测试集分类报告:
               precision    recall  f1-score   support

           F     0.7931    0.1742    0.2857       132
           M     0.6625    0.9727    0.7882       220

    accuracy                         0.6733       352
   macro avg     0.7278    0.5735    0.5370       352
weighted avg     0.7115    0.6733    0.5998       352


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1259, 标准差 = 0.0492
年龄预测模型已保存至: model_age_ruv_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4437, P-value = 0.0000

========================= 所有方法处理完毕 =========================

正在将数值标签转换回 'M'/'F' 以便输出...

处理完成，带有预测结果的完整数据已保存至: expdata_chihope_baseline_744_with_predictions.xlsx
