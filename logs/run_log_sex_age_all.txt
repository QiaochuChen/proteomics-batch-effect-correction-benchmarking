所有输出将被记录到文件: run_log_sex_age_all.txt
============================================================
已将所有列名转换为字符串类型。
已将 'Sex' 列的 'M'/'F' 转换为 1/0。

在数据中找到的方法: ['combat_loess' 'harmony_loess' 'loess' 'log' 'median_loess' 'ratio_loess'
 'ruv_loess']
--------------------------------------------------

========================= 开始处理方法: combat_loess =========================
方法 'combat_loess' 的完整训练集大小: 757
方法 'combat_loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.4110, 标准差 = 0.0516
性别预测模型已保存至: model_sex_combat_loess.joblib
测试集评估 (MCC): 0.3487
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8235    0.2745    0.4118       255
           M     0.6859    0.9642    0.8016       419

    accuracy                         0.7033       674
   macro avg     0.7547    0.6194    0.6067       674
weighted avg     0.7380    0.7033    0.6541       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.2535, 标准差 = 0.0398
年龄预测模型已保存至: model_age_combat_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4338, P-value = 0.0000

========================= 开始处理方法: harmony_loess =========================
方法 'harmony_loess' 的完整训练集大小: 757
方法 'harmony_loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.3967, 标准差 = 0.0256
性别预测模型已保存至: model_sex_harmony_loess.joblib
测试集评估 (MCC): 0.3894
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8721    0.2941    0.4399       255
           M     0.6939    0.9737    0.8103       419

    accuracy                         0.7166       674
   macro avg     0.7830    0.6339    0.6251       674
weighted avg     0.7613    0.7166    0.6702       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.2509, 标准差 = 0.0347
年龄预测模型已保存至: model_age_harmony_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4462, P-value = 0.0000

========================= 开始处理方法: loess =========================
方法 'loess' 的完整训练集大小: 757
方法 'loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2463, 标准差 = 0.0492
性别预测模型已保存至: model_sex_loess.joblib
测试集评估 (MCC): 0.2411
测试集分类报告:
               precision    recall  f1-score   support

           F     0.7959    0.1529    0.2566       255
           M     0.6544    0.9761    0.7835       419

    accuracy                         0.6647       674
   macro avg     0.7252    0.5645    0.5201       674
weighted avg     0.7079    0.6647    0.5842       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1900, 标准差 = 0.0245
年龄预测模型已保存至: model_age_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.3680, P-value = 0.0000

========================= 开始处理方法: log =========================
方法 'log' 的完整训练集大小: 757
方法 'log' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.2870, 标准差 = 0.0419
性别预测模型已保存至: model_sex_log.joblib
测试集评估 (MCC): 0.1820
测试集分类报告:
               precision    recall  f1-score   support

           F     0.7500    0.1059    0.1856       255
           M     0.6426    0.9785    0.7758       419

    accuracy                         0.6484       674
   macro avg     0.6963    0.5422    0.4807       674
weighted avg     0.6833    0.6484    0.5525       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.1760, 标准差 = 0.0240
年龄预测模型已保存至: model_age_log.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.3942, P-value = 0.0000

========================= 开始处理方法: median_loess =========================
方法 'median_loess' 的完整训练集大小: 757
方法 'median_loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.4319, 标准差 = 0.0418
性别预测模型已保存至: model_sex_median_loess.joblib
测试集评估 (MCC): 0.3887
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8300    0.3255    0.4676       255
           M     0.7003    0.9594    0.8097       419

    accuracy                         0.7196       674
   macro avg     0.7652    0.6425    0.6386       674
weighted avg     0.7494    0.7196    0.6803       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.2452, 标准差 = 0.0326
年龄预测模型已保存至: model_age_median_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4379, P-value = 0.0000

========================= 开始处理方法: ratio_loess =========================
方法 'ratio_loess' 的完整训练集大小: 757
方法 'ratio_loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.3873, 标准差 = 0.0491
性别预测模型已保存至: model_sex_ratio_loess.joblib
测试集评估 (MCC): 0.4123
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8660    0.3294    0.4773       255
           M     0.7036    0.9690    0.8153       419

    accuracy                         0.7270       674
   macro avg     0.7848    0.6492    0.6463       674
weighted avg     0.7651    0.7270    0.6874       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.2623, 标准差 = 0.0268
年龄预测模型已保存至: model_age_ratio_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4537, P-value = 0.0000

========================= 开始处理方法: ruv_loess =========================
方法 'ruv_loess' 的完整训练集大小: 757
方法 'ruv_loess' 的测试集大小: 674

--- [任务一: 性别预测 (分类)] ---
交叉验证 (MCC): 平均值 = 0.4204, 标准差 = 0.0503
性别预测模型已保存至: model_sex_ruv_loess.joblib
测试集评估 (MCC): 0.3563
测试集分类报告:
               precision    recall  f1-score   support

           F     0.8667    0.2549    0.3939       255
           M     0.6828    0.9761    0.8035       419

    accuracy                         0.7033       674
   macro avg     0.7747    0.6155    0.5987       674
weighted avg     0.7524    0.7033    0.6486       674


--- [任务二: 年龄预测 (回归)] ---
交叉验证 (R-squared): 平均值 = 0.2551, 标准差 = 0.0230
年龄预测模型已保存至: model_age_ruv_loess.joblib
测试集评估 (Pearson Correlation): 相关系数 = 0.4550, P-value = 0.0000

========================= 所有方法处理完毕 =========================

正在将数值标签转换回 'M'/'F' 以便输出...

处理完成，带有预测结果的完整数据已保存至: expdata_chihope_1431_with_predictions.xlsx
